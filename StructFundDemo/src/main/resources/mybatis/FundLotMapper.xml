<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.newtouch.structfund.mapper.FundLotMapper">
	<resultMap type="com.newtouch.structfund.entity.FundLot" id="BaseResultMap">

		<result column="REGISTER_CODE" property="registerCode" jdbcType="VARCHAR"/>
	 	<result column="FUND_CODE" property="fundCode" jdbcType="VARCHAR"/>
		<result column="LOT_CODE" property="lotCode" jdbcType="VARCHAR"/>
		<result column="LOT_TYPE" property="lotType" jdbcType="VARCHAR"/>
		<result column="START_TIME" property="startTime" jdbcType="VARCHAR"/>
		<result column="FUND_NAME" property="fundName" jdbcType="VARCHAR"/>
		<result column="LOT_STATUS" property="lotStatus" jdbcType="VARCHAR"/>
		<result column="OPERATOR" property="operator" jdbcType="VARCHAR"/>
		<result column="AUTHORIZER" property="authorizer" jdbcType="VARCHAR"/>
	</resultMap>

	<select id="queryFundLot" parameterType="java.util.Map" resultMap="BaseResultMap">
		select * from fund_lot t
		<where>
			<if test="fundLot.registerCode!=null and fundLot.registerCode!=''">
				t.REGISTER_CODE = #{fundLot.registerCode}
			</if>
			<if test="fundLot.fundCode !=null and fundLot.fundCode!=''">
				t.FUND_CODE LIKE CONCAT(CONCAT('%', #{fundLot.fundCode}), '%')
			</if>
		</where>
		limit #{startRow},#{pageSize}
	</select>

	<delete id="delete" parameterType="java.util.List">
		delete from fund_lot where registerCode in
		<foreach collection="list" item="id" open="(" separator="," close=")">
			#{id}
		</foreach>
	</delete>

	<select id="getOne" parameterType="com.newtouch.structfund.entity.FundLot" resultType="com.newtouch.structfund.entity.FundLot">
		select * from fund_lot t where t.registerCode = #{registerCode}
	</select>
	
	<insert id="insert" parameterType="com.newtouch.structfund.entity.FundLot">
		insert into fund_lot(registerCode,fundCode,lotCode,startTime) values(#{registerCode},#{fundCode},#{lotCode},#{startTime})
	</insert>

	<update id="update" parameterType="com.newtouch.structfund.entity.FundLot">
		update fund_lot set lotCode=#{lotCode},startTime=#{startTime} where registerCode=#{registerCode} and fundCode=#{fundCode}
	</update>
</mapper>
